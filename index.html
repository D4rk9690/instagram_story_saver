<!DOCTYPE html>
<html>
<head>
    <title>Story Downloader</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #121212;
            color: #fff;
        }

        #loading-container,
        #completion-message,
        #log-container {
            background-color: #1e1e1e;
            border-radius: 8px;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
        }

        #loading-container h2,
        #completion-message h1,
        #log-container h2 {
            margin: 0;
        }

        .loading-icon {
            animation: spin 2s linear infinite;
            font-size: 48px;
        }

        #completion-message {
            display: none;
        }

        #log-container {
            margin-top: 20px;
            padding: 10px;
            background-color: #2d2d2d;
        }

        pre {
            white-space: pre-wrap;
            margin: 0;
            padding: 10px;
            background-color: #2d2d2d;
            border-radius: 4px;
            font-family: monospace;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
<div id="loading-container">
    <h2>Loading...</h2>
    <div class="loading-icon">&#9203;</div>
    <div id="status" class="log-container"></div>
</div>

<div id="completion-message">
    <h1>Download Complete!</h1>
    <div id="log-container">
        <h2>Log</h2>
        <pre id="log-content"></pre>
    </div>
</div>

<script>
    async function fetchData() {
        try {
            setStatus('Getting account info');
            await delay(3000);
            setStatus('Fetching the data');
            await delay(2000);
            setStatus('Downloading story');
            await delay(150);
            setStatus('1%');
            await delay(150);
            setStatus('2%');
            await delay(150);
            setStatus('3%');
            await delay(150);
            setStatus('4%');
            await delay(150);
            setStatus('5%');
            await delay(150);
            setStatus('6%');
            await delay(150);
            setStatus('7%');
            await delay(150);
            setStatus('8%');
            await delay(150);
            setStatus('9%');
            await delay(150);
            setStatus('10%');
            await delay(150);
            setStatus('11%');
            await delay(150);
            setStatus('12%');
            await delay(150);
            setStatus('13%');
            await delay(150);
            setStatus('14%');
            await delay(150);
            setStatus('15%');
            await delay(150);
            setStatus('16%');
            await delay(150);
            setStatus('17%');
            await delay(150);
            setStatus('18%');
            await delay(150);
            setStatus('19%');
            await delay(150);
            setStatus('20%');
            await delay(150);
            setStatus('21%');
            await delay(150);
            setStatus('22%');
            await delay(150);
            setStatus('23%');
            await delay(150);
            setStatus('24%');
            await delay(150);
            setStatus('25%');
            await delay(150);
            setStatus('26%');
            await delay(150);
            setStatus('27%');
            await delay(150);
            setStatus('28%');
            await delay(150);
            setStatus('29%');
            await delay(150);
            setStatus('30%');
            await delay(150);
            setStatus('31%');
            await delay(150);
            setStatus('32%');
            await delay(150);
            setStatus('33%');
            await delay(150);
            setStatus('34%');
            await delay(150);
            setStatus('35%');
            await delay(150);
            setStatus('36%');
            await delay(150);
            setStatus('37%');
            await delay(150);
            setStatus('38%');
            await delay(150);
            setStatus('39%');
            await delay(150);
            setStatus('40%');
            await delay(150);
            setStatus('41%');
            await delay(150);
            setStatus('42%');
            await delay(150);
            setStatus('43%');
            await delay(150);
            setStatus('44%');
            await delay(150);
            setStatus('45%');
            await delay(150);
            setStatus('46%');
            await delay(150);
            setStatus('47%');
            await delay(150);
            setStatus('48%');
            await delay(150);
            setStatus('49%');
            await delay(150);
            setStatus('50%');
            await delay(150);
            setStatus('51%');
            await delay(150);
            setStatus('52%');
            await delay(150);
            setStatus('53%');
            await delay(150);
            setStatus('54%');
            await delay(150);
            setStatus('55%');
            await delay(150);
            setStatus('56%');
            await delay(150);
            setStatus('57%');
            await delay(150);
            setStatus('58%');
            await delay(150);
            setStatus('59%');
            await delay(150);
            setStatus('60%');
            await delay(150);
            setStatus('61%');
            await delay(150);
            setStatus('62%');
            await delay(150);
            setStatus('63%');
            await delay(150);
            setStatus('64%');
            await delay(150);
            setStatus('65%');
            await delay(150);
            setStatus('66%');
            await delay(150);
            setStatus('67%');
            await delay(150);
            setStatus('68%');
            await delay(150);
            setStatus('69%');
            await delay(150);
            setStatus('70%');
            await delay(150);
            setStatus('71%');
            await delay(150);
            setStatus('72%');
            await delay(150);
            setStatus('73%');
            await delay(150);
            setStatus('74%');
            await delay(150);
            setStatus('75%');
            await delay(150);
            setStatus('76%');
            await delay(150);
            setStatus('77%');
            await delay(150);
            setStatus('78%');
            await delay(150);
            setStatus('79%');
            await delay(150);
            setStatus('80%');
            await delay(150);
            setStatus('81%');
            await delay(150);
            setStatus('82%');
            await delay(150);
            setStatus('83%');
            await delay(150);
            setStatus('84%');
            await delay(150);
            setStatus('85%');
            await delay(150);
            setStatus('86%');
            await delay(150);
            setStatus('87%');
            await delay(150);
            setStatus('88%');
            await delay(150);
            setStatus('89%');
            await delay(150);
            setStatus('90%');
            await delay(150);
            setStatus('91%');
            await delay(150);
            setStatus('92%');
            await delay(150);
            setStatus('93%');
            await delay(150);
            setStatus('94%');
            await delay(150);
            setStatus('95%');
            await delay(150);
            setStatus('96%');
            await delay(150);
            setStatus('97%');
            await delay(150);
            setStatus('98%');
            await delay(150);
            setStatus('99%');
            await delay(150);
            setStatus('100%');

            const response = await fetch('run_script.php');
            const data = await response.json();

            document.getElementById('loading-container').style.display = 'none';
            document.getElementById('completion-message').style.display = 'block';
            updateLog(data.logContent);
        } catch (error) {
            console.error(error);
        }
    }

    function setStatus(statusText) {
        const statusElement = document.getElementById('status');
        statusElement.textContent = statusText;
    }

    function updateLog(logContent) {
        const logContainer = document.getElementById('log-content');
        logContainer.textContent = logContent;
    }

    function delay(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }

    fetchData();
</script>
</body>
</html>